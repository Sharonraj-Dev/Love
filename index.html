<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For My Dearest Sneha</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:wght@400;700&family=Crimson+Text:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Your existing CSS remains exactly the same until music player */
        
        /* Enhanced Music Player */
        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 50px;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 107, 107, 0.3);
        }
        .music-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s ease;
        }
        .music-btn:hover {
            background: #d46a6a;
            transform: scale(1.1);
        }
        .music-btn.playing {
            background: #d46a6a;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(212, 106, 106, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(212, 106, 106, 0); }
            100% { box-shadow: 0 0 0 0 rgba(212, 106, 106, 0); }
        }
        .music-text {
            margin-left: 12px;
            font-size: 14px;
            color: #5a3e36;
            font-style: italic;
            font-weight: 500;
            min-width: 80px;
        }
        .music-error {
            color: #ff4757;
        }
    </style>
</head>
<body>
    <!-- Your existing HTML content remains exactly the same -->
    <div class="container">
        <div class="floating-hearts" id="hearts-container"></div>
        <div class="bg-decoration" id="bgDecoration"></div>
        <div class="confetti" id="confetti"></div>
       
        <div class="envelope-wrapper">
            <div class="envelope" id="envelope">
                <div class="letter" id="letter">
                    <h2>For My Sneha</h2>
                    <p>Click to open my heart...</p>
                </div>
                <div class="heart">❤️</div>
            </div>
        </div>
       
        <div class="full-letter" id="fullLetter">
            <button class="close-btn" id="closeBtn">×</button>
            <div class="letter-content">
                <div class="letter-header">
                    <h1>To My Dearest Sneha</h1>
                    <h2>A Letter From My Heart</h2>
                </div>
               
                <div class="letter-body">
                    <p>My Love,</p>
                   
                    <p>From the moment you entered my life, everything changed. The colors became brighter, the days became more meaningful, and my heart found its home in yours. Every day with you is a blessing I never knew I needed but now cannot imagine living without.</p>
                   
                    <p>Your smile lights up my world in ways that words could never fully capture. Your laughter is my favorite melody, and your presence brings a peace to my soul that I've never known before. In your eyes, I see my future, my happiness, and all the love I could ever hope for.</p>
                   
                    <div class="quote">
                        "In you, I've found the love of my life and my closest, truest friend. You are my today and all of my tomorrows."
                    </div>
                   
                    <p>I promise to cherish you, to support you in all your dreams, to be your shelter in storms, and your partner in laughter. I will love you not only for who you are but for who I am when I'm with you.</p>
                   
                    <p>You are the most beautiful person I know, inside and out, and I feel incredibly lucky to call you mine.</p>
                   
                    <p>With all my love, now and forever,</p>
                   
                    <div class="signature">
                        Yours always<br>
                        Sharon
                    </div>
                </div>
            </div>
        </div>
       
        <div class="music-player">
            <button class="music-btn" id="musicBtn">
                <i class="fas fa-music"></i>
            </button>
            <div class="music-text" id="musicText">Play Music</div>
        </div>
    </div>

    <!-- Audio Element -->
    <audio id="backgroundMusic" loop preload="metadata">
        <source src="song.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <script>
        // Music Player Functionality
        const musicBtn = document.getElementById('musicBtn');
        const musicText = document.getElementById('musicText');
        const backgroundMusic = document.getElementById('backgroundMusic');
        let isPlaying = false;

        // Test if audio file exists and is accessible
        function testAudioFile() {
            fetch('song.mp3')
                .then(response => {
                    if (response.ok) {
                        console.log('Audio file found and accessible');
                        musicText.textContent = 'Play Music';
                    } else {
                        console.error('Audio file not found or inaccessible');
                        musicText.textContent = 'Music File Missing';
                        musicText.classList.add('music-error');
                        musicBtn.disabled = true;
                        musicBtn.style.opacity = '0.5';
                    }
                })
                .catch(error => {
                    console.error('Error loading audio file:', error);
                    musicText.textContent = 'Load Error';
                    musicText.classList.add('music-error');
                    musicBtn.disabled = true;
                    musicBtn.style.opacity = '0.5';
                });
        }

        // Enhanced music toggle function
        function toggleMusic() {
            if (isPlaying) {
                // Pause music
                backgroundMusic.pause();
                musicText.textContent = 'Play Music';
                musicBtn.innerHTML = '<i class="fas fa-music"></i>';
                musicBtn.classList.remove('playing');
                isPlaying = false;
            } else {
                // Play music with better error handling
                const playPromise = backgroundMusic.play();
                
                if (playPromise !== undefined) {
                    playPromise
                        .then(() => {
                            // Successfully started playing
                            musicText.textContent = 'Playing...';
                            musicBtn.innerHTML = '<i class="fas fa-pause"></i>';
                            musicBtn.classList.add('playing');
                            isPlaying = true;
                        })
                        .catch(error => {
                            console.error('Playback failed:', error);
                            
                            if (error.name === 'NotAllowedError') {
                                musicText.textContent = 'Click to Play';
                                // Show user-friendly message
                                setTimeout(() => {
                                    alert('Please click the music button to play. Autoplay is blocked by your browser.');
                                }, 100);
                            } else if (error.name === 'NotSupportedError') {
                                musicText.textContent = 'Format Error';
                                musicText.classList.add('music-error');
                            } else {
                                musicText.textContent = 'Play Failed';
                                musicText.classList.add('music-error');
                            }
                        });
                }
            }
        }

        // Audio event listeners
        backgroundMusic.addEventListener('loadeddata', function() {
            console.log('Audio loaded successfully');
            musicText.textContent = 'Play Music';
        });

        backgroundMusic.addEventListener('error', function(e) {
            console.error('Audio error:', e);
            console.error('Error details:', backgroundMusic.error);
            musicText.textContent = 'Audio Error';
            musicText.classList.add('music-error');
            musicBtn.disabled = true;
            musicBtn.style.opacity = '0.5';
        });

        backgroundMusic.addEventListener('canplay', function() {
            console.log('Audio can be played');
            musicBtn.disabled = false;
            musicBtn.style.opacity = '1';
        });

        // Event listener for music button
        musicBtn.addEventListener('click', toggleMusic);

        // Your existing JavaScript for envelope, etc. remains the same
        const envelope = document.getElementById('envelope');
        const letter = document.getElementById('letter');
        const fullLetter = document.getElementById('fullLetter');
        const closeBtn = document.getElementById('closeBtn');
        const confetti = document.getElementById('confetti');

        envelope.addEventListener('click', function() {
            envelope.classList.add('open');
            letter.classList.add('open');
           
            createConfetti();
            setTimeout(() => {
                confetti.classList.add('active');
                setTimeout(() => {
                    confetti.classList.remove('active');
                }, 3000);
            }, 500);
           
            setTimeout(() => {
                fullLetter.classList.add('active');
            }, 800);
        });

        function createConfetti() {
            confetti.innerHTML = '';
            const colors = ['#ff6b6b', '#ff8e8e', '#d46a6a', '#ffb6c1'];
            const pieceCount = 50;
           
            for (let i = 0; i < pieceCount; i++) {
                const piece = document.createElement('div');
                piece.classList.add('confetti-piece');
                piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                piece.style.left = Math.random() * 100 + 'vw';
                piece.style.animationDelay = Math.random() * 0.5 + 's';
                piece.style.animationDuration = (2 + Math.random() * 2) + 's';
                confetti.appendChild(piece);
            }
        }

        closeBtn.addEventListener('click', function() {
            fullLetter.classList.remove('active');
            setTimeout(() => {
                envelope.classList.remove('open');
                letter.classList.remove('open');
            }, 500);
        });

        fullLetter.addEventListener('click', function(e) {
            if (e.target === this) {
                fullLetter.classList.remove('active');
                setTimeout(() => {
                    envelope.classList.remove('open');
                    letter.classList.remove('open');
                }, 500);
            }
        });

        function createHearts() {
            const heartsContainer = document.getElementById('hearts-container');
            const heartCount = 20;
           
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('floating-heart');
                heart.innerHTML = '❤️';
               
                const left = Math.random() * 100;
                const delay = Math.random() * 5;
                const duration = 6 + Math.random() * 4;
               
                heart.style.left = `${left}vw`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
               
                heartsContainer.appendChild(heart);
            }
        }

        function createBgDecoration() {
            const bgDecoration = document.getElementById('bgDecoration');
            const heartCount = 8;
           
            for (let i = 0; i < heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('bg-heart');
                heart.innerHTML = '❤️';
               
                const top = Math.random() * 100;
                const left = Math.random() * 100;
                const delay = Math.random() * 20;
                const duration = 25 + Math.random() * 20;
               
                heart.style.top = `${top}vh`;
                heart.style.left = `${left}vw`;
                heart.style.animationDelay = `${delay}s`;
                heart.style.animationDuration = `${duration}s`;
               
                bgDecoration.appendChild(heart);
            }
        }

        // Initialize
        window.addEventListener('load', function() {
            createHearts();
            createBgDecoration();
            testAudioFile(); // Test if audio file exists
            
            envelope.style.opacity = '0';
            envelope.style.transform = 'scale(0.8)';
            setTimeout(() => {
                envelope.style.transition = 'all 1s ease';
                envelope.style.opacity = '1';
                envelope.style.transform = 'scale(1)';
            }, 500);

            // Set volume
            backgroundMusic.volume = 0.7;
        });
    </script>
</body>
</html>
